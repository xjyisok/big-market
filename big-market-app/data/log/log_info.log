25-09-30.22:23:38.327 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_462 on DESKTOP-8JHLMP8 with PID 22344 (started by XDUAI in D:\javacode\WebProj\big-market\big-market\big-market-app)
25-09-30.22:23:38.328 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-09-30.22:23:39.337 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-09-30.22:23:39.342 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-09-30.22:23:39.388 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 26 ms. Found 0 Redis repository interfaces.
25-09-30.22:23:40.535 [main            ] INFO  Version                - Redisson 3.23.4
25-09-30.22:23:40.790 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-09-30.22:23:40.804 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-09-30.22:23:43.711 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-09-30.22:23:43.803 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-09-30.22:23:43.896 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#3120495d:0/SimpleConnection@4ec27c4c [delegate=amqp://admin@127.0.0.1:5672/, localPort= 50547]
25-09-30.22:23:44.000 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 6.051 seconds (JVM running for 13.59)
25-09-30.22:23:44.190 [main            ] INFO  IRaffleStrategyController - 查询抽奖策略权重规则配置开始 userId:xiaofuge activityId：100301
25-09-30.22:23:44.231 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-09-30.22:23:44.682 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-09-30.22:23:44.720 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-09-30.22:23:44.744 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-09-30.22:23:45.000 [main            ] INFO  IRaffleStrategyController - 查询抽奖策略权重规则配置完成 userId:xiaofuge activityId：100301 response: {"code":"0000","data":[{"ruleWeightCount":4000,"strategyAwards":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"}],"userActivityAccountTotalUseCount":8862},{"ruleWeightCount":60,"strategyAwards":[{"awardId":102,"awardTitle":"OpenAI会员卡"}],"userActivityAccountTotalUseCount":8862},{"ruleWeightCount":5000,"strategyAwards":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"},{"awardId":106,"awardTitle":"轻奢办公椅"},{"awardId":107,"awardTitle":"小霸王游戏机"}],"userActivityAccountTotalUseCount":8862},{"ruleWeightCount":6000,"strategyAwards":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"},{"awardId":106,"awardTitle":"轻奢办公椅"},{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"userActivityAccountTotalUseCount":8862}],"info":"成功"}
25-09-30.22:23:45.002 [main            ] INFO  RaffleStrategyControllerTest - 请求参数：{"activityId":100301,"userId":"xiaofuge"}
25-09-30.22:23:45.004 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0000","data":[{"ruleWeightCount":4000,"strategyAwards":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"}],"userActivityAccountTotalUseCount":8862},{"ruleWeightCount":60,"strategyAwards":[{"awardId":102,"awardTitle":"OpenAI会员卡"}],"userActivityAccountTotalUseCount":8862},{"ruleWeightCount":5000,"strategyAwards":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"},{"awardId":106,"awardTitle":"轻奢办公椅"},{"awardId":107,"awardTitle":"小霸王游戏机"}],"userActivityAccountTotalUseCount":8862},{"ruleWeightCount":6000,"strategyAwards":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"},{"awardId":106,"awardTitle":"轻奢办公椅"},{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"userActivityAccountTotalUseCount":8862}],"info":"成功"}
25-09-30.22:23:45.009 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-09-30.22:23:45.028 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-09-30.22:23:45.030 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-09-30.22:23:45.033 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-09-30.22:23:45.034 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-09-30.22:23:45.037 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-09-30.22:23:45.985 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-09-30.22:23:45.996 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-09-30.22:23:45.996 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-09-30.22:23:45.999 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-09-30.22:23:45.999 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-09-30.22:23:45.999 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:38:29.403 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_462 on DESKTOP-8JHLMP8 with PID 19184 (started by XDUAI in D:\javacode\WebProj\big-market\big-market\big-market-app)
25-10-11.20:38:29.413 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-10-11.20:38:31.643 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-10-11.20:38:31.645 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-10-11.20:38:31.684 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 23 ms. Found 0 Redis repository interfaces.
25-10-11.20:38:32.828 [main            ] INFO  Version                - Redisson 3.23.4
25-10-11.20:38:33.062 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-10-11.20:38:33.075 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-10-11.20:38:35.779 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-10-11.20:38:35.861 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-10-11.20:38:35.952 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#1a0f349:0/SimpleConnection@4148ce43 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 54538]
25-10-11.20:38:36.046 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 7.044 seconds (JVM running for 8.188)
25-10-11.20:38:36.237 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-10-11.20:38:36.458 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-10-11.20:38:36.493 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-10-11.20:38:36.520 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-10-11.20:38:37.239 [main            ] INFO  EventPublisher         - 发送MQ消息 topic:send_rebate message:{"data":{"bizId":"user003_sku_20251011","rebateConfig":"9011","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"user003"},"id":"33016917825","timestamp":1760186316490}
25-10-11.20:38:37.249 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BehaviorRebateServiceTaskConsumer - 监听返利消息topic:send_rebate,message:{"data":{"bizId":"user003_sku_20251011","rebateConfig":"9011","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"user003"},"id":"33016917825","timestamp":1760186316490}
25-10-11.20:38:37.349 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期，状态】校验开始
25-10-11.20:38:37.349 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  ActivitySkuStockActionChain - 活动责任链-库存信息【有效期，状态】校验开始sku:9011,activityId:100301
25-10-11.20:38:37.357 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期库存处理成功】sku:9011,activityId:100301
25-10-11.20:38:37.388 [main            ] INFO  EventPublisher         - 发送MQ消息 topic:send_rebate message:{"data":{"bizId":"user003_integral_20251011","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"user003"},"id":"14316642635","timestamp":1760186316492}
25-10-11.20:38:37.696 [main            ] INFO  IRaffleActivityController - 日历签到返利完成userID:user003,orderIds:[335262389504, 959480617905]
25-10-11.20:38:37.700 [main            ] INFO  RaffleActivityControllerTest - 测试结果：{"code":"0000","data":true,"info":"成功"}
25-10-11.20:38:37.713 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:38:37.746 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:38:37.748 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:38:37.762 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:38:38.033 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:38:38.049 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:38:38.067 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:38:38.069 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:38:38.069 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:40:39.820 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_462 on DESKTOP-8JHLMP8 with PID 19400 (started by XDUAI in D:\javacode\WebProj\big-market\big-market\big-market-app)
25-10-11.20:40:39.821 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-10-11.20:40:40.745 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-10-11.20:40:40.749 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-10-11.20:40:40.792 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 25 ms. Found 0 Redis repository interfaces.
25-10-11.20:40:41.934 [main            ] INFO  Version                - Redisson 3.23.4
25-10-11.20:40:42.176 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-10-11.20:40:42.190 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-10-11.20:40:44.973 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-10-11.20:40:45.075 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-10-11.20:40:45.144 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7babed9e:0/SimpleConnection@a6fc1bc [delegate=amqp://admin@127.0.0.1:5672/, localPort= 54858]
25-10-11.20:40:45.226 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BehaviorRebateServiceTaskConsumer - 监听返利消息topic:send_rebate,message:{"data":{"bizId":"user003_integral_20251011","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"user003"},"id":"14316642635","timestamp":1760186316492}
25-10-11.20:40:45.242 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 5.818 seconds (JVM running for 6.633)
25-10-11.20:40:45.409 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BehaviorRebateServiceTaskConsumer - 非sku任务暂时不处理topic:send_rebate,message:{"data":{"bizId":"user003_integral_20251011","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"user003"},"id":"14316642635","timestamp":1760186316492}
25-10-11.20:40:45.441 [main            ] INFO  IRaffleActivityController - 活动抽奖 activity id 100301 userId user003
25-10-11.20:40:45.528 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-10-11.20:40:45.740 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-10-11.20:40:46.030 [main            ] INFO  IRaffleActivityController - 开始抽奖 activity id 100301 userId user003 orderId 713179568564
25-10-11.20:40:46.033 [main            ] INFO  BlackListLogicChain    - 抽奖责任链-黑名单开始userId:user003,strategyId:100006,rulemodel:rule_blacklist
25-10-11.20:40:46.097 [main            ] ERROR IRaffleActivityController - 活动抽奖失败 userId:user003 activityId:100301
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: java.sql.SQLSyntaxErrorException: Table 'big_market_01.strategy_rule' doesn't exist
### The error may exist in file [D:\javacode\WebProj\big-market\big-market\big-market-app\target\classes\mybatis\mapper\strategy_rule_mapper.xml]
### The error may involve cn.bugstack.infrastructure.persistent.dao.IStrategyRuleDao.queryStrategyRuleValue-Inline
### The error occurred while setting parameters
### SQL: select rule_value from strategy_rule         where strategy_id = ? and rule_model = ?
### Cause: java.sql.SQLSyntaxErrorException: Table 'big_market_01.strategy_rule' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'big_market_01.strategy_rule' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy112.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:160)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:87)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy134.queryStrategyRuleValue(Unknown Source)
	at cn.bugstack.infrastructure.persistent.repository.StrategyRespositoryImpl.queryStrategyRuleValue(StrategyRespositoryImpl.java:163)
	at cn.bugstack.domain.strategy.service.rule.chain.Impl.BlackListLogicChain.logic(BlackListLogicChain.java:24)
	at cn.bugstack.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:59)
	at cn.bugstack.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.bugstack.trigger.http.IRaffleActivityController.draw(IRaffleActivityController.java:96)
	at cn.bugstack.test.domain.trigger.RaffleActivityControllerTest.test_blacklist_draw(RaffleActivityControllerTest.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:251)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:190)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:231)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: java.sql.SQLSyntaxErrorException: Table 'big_market_01.strategy_rule' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:64)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:79)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy209.query(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:63)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:325)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:89)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:147)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:140)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 45 common frames omitted
25-10-11.20:40:46.110 [main            ] INFO  RaffleActivityControllerTest - 请求参数：{"activityId":100301,"userId":"user003"}
25-10-11.20:40:46.122 [main            ] INFO  RaffleActivityControllerTest - 测试结果：{"code":"0001","info":"未知失败"}
25-10-11.20:40:50.008 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-10-11.20:40:50.028 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:40:50.031 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-10-11.20:40:55.006 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:41:00.016 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:41:01.084 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:41:01.086 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:41:01.087 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:41:01.331 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:41:01.331 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:41:01.540 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:41:01.543 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:41:01.543 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:41:01.544 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:45:22.958 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_462 on DESKTOP-8JHLMP8 with PID 11596 (started by XDUAI in D:\javacode\WebProj\big-market\big-market\big-market-app)
25-10-11.20:45:22.958 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-10-11.20:45:23.860 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-10-11.20:45:23.860 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-10-11.20:45:23.901 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 24 ms. Found 0 Redis repository interfaces.
25-10-11.20:45:24.978 [main            ] INFO  Version                - Redisson 3.23.4
25-10-11.20:45:25.192 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-10-11.20:45:25.203 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-10-11.20:45:27.780 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-10-11.20:45:27.864 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-10-11.20:45:27.930 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#9729a97:0/SimpleConnection@6a0e97fc [delegate=amqp://admin@127.0.0.1:5672/, localPort= 55430]
25-10-11.20:45:28.016 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 5.479 seconds (JVM running for 6.353)
25-10-11.20:45:28.191 [main            ] INFO  IRaffleActivityController - 活动抽奖 activity id 100301 userId user003
25-10-11.20:45:28.324 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-10-11.20:45:28.560 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-10-11.20:45:28.794 [main            ] INFO  AbstractRaffleActivityPartake - 存在未消费的抽奖订单userId:user003,activityId:100301 userorderentity:{"activityId":100301,"activityName":"测试活动","orderId":"713179568564","orderState":"create","orderTime":1760186445000,"strategyId":100006,"userId":"user003"}
25-10-11.20:45:28.794 [main            ] INFO  IRaffleActivityController - 开始抽奖 activity id 100301 userId user003 orderId 713179568564
25-10-11.20:45:28.817 [main            ] INFO  BlackListLogicChain    - 抽奖责任链-黑名单开始userId:user003,strategyId:100006,rulemodel:rule_blacklist
25-10-11.20:45:28.837 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-10-11.20:45:28.859 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-10-11.20:45:28.863 [main            ] INFO  BlackListLogicChain    - 抽奖责任链-黑名单接管userId:user003,strategyId:100006,rulemodel:rule_blacklist
25-10-11.20:45:28.878 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 user003 100006 101 rule_blacklist
25-10-11.20:45:28.935 [main            ] INFO  AwardRespositoryImpl   - 当前路由到的库：01
25-10-11.20:45:29.181 [main            ] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardConfig":"0.01,1","awardId":101,"awardTitle":"随机积分","orderId":"713179568564","userId":"user003"},"id":"82351201990","timestamp":1760186728901}
25-10-11.20:45:29.189 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardConfig":"0.01,1","awardId":101,"awardTitle":"随机积分","orderId":"713179568564","userId":"user003"},"id":"82351201990","timestamp":1760186728901}
25-10-11.20:45:29.997 [main            ] INFO  RaffleActivityControllerTest - 请求参数：{"activityId":100301,"userId":"user003"}
25-10-11.20:45:30.001 [main            ] INFO  RaffleActivityControllerTest - 测试结果：{"code":"0000","data":{"awardId":101,"awardIndex":1,"awardTitle":"随机积分"},"info":"成功"}
25-10-11.20:45:30.008 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-10-11.20:45:30.028 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:45:30.031 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-10-11.20:45:35.012 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:45:40.009 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:45:45.018 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:45:50.015 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:45:55.013 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:46:00.019 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:46:05.015 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:46:10.009 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:46:15.013 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:46:18.941 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:46:18.943 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:46:18.944 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:46:19.375 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:46:19.375 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:46:19.874 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:46:19.877 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:46:19.878 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:46:19.878 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:46:22.543 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_462 on DESKTOP-8JHLMP8 with PID 15232 (started by XDUAI in D:\javacode\WebProj\big-market\big-market\big-market-app)
25-10-11.20:46:22.545 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-10-11.20:46:24.884 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-10-11.20:46:24.884 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-10-11.20:46:24.931 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 26 ms. Found 0 Redis repository interfaces.
25-10-11.20:46:26.047 [main            ] INFO  Version                - Redisson 3.23.4
25-10-11.20:46:26.285 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-10-11.20:46:26.300 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-10-11.20:46:29.208 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-10-11.20:46:29.295 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-10-11.20:46:29.360 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#22b7ef2b:0/SimpleConnection@7e9a836 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 55659]
25-10-11.20:46:29.449 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 7.379 seconds (JVM running for 8.346)
25-10-11.20:46:29.641 [main            ] INFO  IRaffleActivityController - 活动抽奖 activity id 100301 userId user003
25-10-11.20:46:29.733 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-10-11.20:46:29.967 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-10-11.20:46:30.011 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-10-11.20:46:30.025 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:46:30.038 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-10-11.20:46:30.191 [main            ] INFO  IRaffleActivityController - 开始抽奖 activity id 100301 userId user003 orderId 878418293479
25-10-11.20:46:30.196 [main            ] INFO  BlackListLogicChain    - 抽奖责任链-黑名单开始userId:user003,strategyId:100006,rulemodel:rule_blacklist
25-10-11.20:46:30.220 [main            ] INFO  BlackListLogicChain    - 抽奖责任链-黑名单接管userId:user003,strategyId:100006,rulemodel:rule_blacklist
25-10-11.20:46:30.221 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 user003 100006 101 rule_blacklist
25-10-11.20:46:30.407 [main            ] INFO  AwardRespositoryImpl   - 当前路由到的库：01
25-10-11.20:46:30.643 [main            ] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardConfig":"0.01,1","awardId":101,"awardTitle":"随机积分","orderId":"878418293479","userId":"user003"},"id":"42387000596","timestamp":1760186790230}
25-10-11.20:46:30.651 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardConfig":"0.01,1","awardId":101,"awardTitle":"随机积分","orderId":"878418293479","userId":"user003"},"id":"42387000596","timestamp":1760186790230}
25-10-11.20:46:30.830 [main            ] INFO  RaffleActivityControllerTest - 请求参数：{"activityId":100301,"userId":"user003"}
25-10-11.20:46:30.832 [main            ] INFO  RaffleActivityControllerTest - 测试结果：{"code":"0000","data":{"awardId":101,"awardIndex":1,"awardTitle":"随机积分"},"info":"成功"}
25-10-11.20:46:35.021 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:46:40.017 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:46:45.015 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:46:50.015 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:46:55.014 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:47:00.020 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:47:05.007 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:47:10.003 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:47:14.352 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:47:14.353 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:47:14.354 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-10-11.20:47:14.696 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:47:14.741 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:47:15.010 [scheduling-1    ] INFO  UpdateAwardStockJob    - 当前无事务
25-10-11.20:47:15.177 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-10-11.20:47:15.180 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:47:15.180 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-10-11.20:47:15.180 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
